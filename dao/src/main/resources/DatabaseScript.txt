create database epam_jwd_db;
use epam_jwd_db;

create table Addresses(
id bigint primary key auto_increment,
city varchar(30) not null,
street text not null,
building varchar(15) not null,
apartment varchar(15)
);

create table Users (
id bigint primary key auto_increment,
fName varchar(25),
lName varchar(25),
phone varchar(15) not null,
address_id bigint
);

create table UserAccounts(
id bigint primary key auto_increment,
login varchar(50) unique not null,
password varchar(50) not null,
role varchar(25) not null,
user_id bigint not null
);

create table Products(
id bigint primary key auto_increment,
name varchar(30) not null,
description text,
price integer not null,
isAvailable bool not null
);

create table Orders(
id bigint primary key auto_increment,
date datetime not null,
status varchar(30) not null,
product_amount integer default 1,
product_id bigint,
customer_id bigint,
foreign key (product_id) references Products(id),
foreign key (customer_id) references UserAccounts(id)
);

select * from UserAccounts;
insert into Users (fName,lName,phone, address_id)
values
("Lulka", "Valova", "9740419", 1),
("Marina", "Valova", "3606384", 1),
("Vera", "Kolesinskaya", "6545838", 2);

insert into Addresses (city, street, building,apartment)
values
("Lida", "Nevskogo", "50", "17");

insert into UserAccounts (login, password, role, user_id)
values
("Marina2", "9999999", "admin", (select id from Users where Users.fname = "Marina" and phone = "3606384"));

select UserAccounts.id, Users.id , login, password, role, fName, lName, phone, Addresses.id, city, street, building,apartment from UserAccounts
left join Users on Users.id = UserAccounts.user_id
left join Addresses on Addresses.id = Users.address_id;


